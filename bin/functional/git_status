#!/usr/bin/env ipython3
import os
os.chdir("/home/amir/github")

command="""
IFS=$'\n'
find . -size +49M -exec du -sh {} \; | grep -v ".pack$\|ames_data_for_NER.zip\|files_for_downlode.zip" | sort -h > /home/amir/.amda_amir
if [ `cat /home/amir/.amda_amir | wc -l` -gt 0 ] ; then 
	cat /home/amir/.amda_amir
fi
""".strip()
f = list(os.popen(command))
os.remove("/home/amir/.amda_amir")
if f:
	print("\n\n")
	from termcolor import colored
	print(colored("""
-------------- Filese Larger then 49 MB --------------
NOTE: files > 49 are not allowd. either remove this/these file/s or move it/these to another directory
	""".strip(), "red"))
	f = [i.replace("\t.", "\tgithub" ).strip() for i in f]
	for i in f:
		print(colored(i, 'green'))
	print("\n\n")
if "git_files.txt" in os.listdir():
	os.system("rm git_files.txt")
aa = True

not_to_commit_repos = ["lfd-projects"]
if not_to_commit_repos:
	print("************************************")
for i in not_to_commit_repos:
	print(f"<{i}> repository excluded from this opereation\n")

repos = os.listdir() # list of all local repositories
repos = [repo for repo in repos if not repo in not_to_commit_repos and not repo.startswith(".")]
r = ["Your branch is up to date with 'origin/master'.\n", '\n', 'Changes not staged for commit:\n', '  (use "git add <file>..." to update what will be committed)\n', '  (use "git checkout -- <file>..." to discard changes in working directory)\n', 'no changes added to commit (use "git add" and/or "git commit -a")\n']
d_ = {"To be pushed" : [],
	   "To be commit" : []}
for i in repos:
	os.chdir(i)
	a = list(os.popen("git status"))
	if not ''.join(a) in [
			"On branch master\nYour branch is up to date with 'origin/master'.\n\nnothing to commit, working tree clean\n", "On branch main\nYour branch is up to date with 'origin/main'.\n\nnothing to commit, working tree clean\n"]:	
		if 'use "git push" to publish your local commits' in ''.join(a):
			if not '(use "git add <file>..." to update what will be committed)' in ''.join(a):
				# print("To be pushed: >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>", i)
				d_['To be pushed'].append(i)
				aa = False
				os.chdir("../")
				continue
			else:
				# print("To be commit: >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>", i)
				d_['To be commit'].append(i)
			#print("*"*10, i, "*"*10)
			#a = os.popen("git status")
			#aa = False
			#for z in list(a)[2:]:
			#	if z in r:
			#		continue
			#	if not z == "\n":
			#		print(z.replace("\n", ""))
			#print("\n")
	else:
		lst = True
	os.chdir("../")

for k,v in d_.items():
	for val in v:
		print(k, ": >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>", val)
	print()



if aa:
	print("Nothing to Add or Push")
print()
