#!/usr/bin/ipython3
import os
from termcolor import colored
import requests
from bs4 import BeautifulSoup
_file_name_ = "/home/amir/github/Amir-personal/.kurulus_usman_last_downloaded.txt"
s = BeautifulSoup(requests.get("https://ardirilisertugrul.net/Kurulus-Osman/1.php?id=60").text, 'lxml')
n = max([int(i.text.strip("episode ")) for i in s.select("button", {"class" : "btn btn-info"}) if i.text.startswith("episode") ])
last_vid_num = int(open(_file_name_, 'r').read().strip())
last_vid = f"https://ardirilisertugrul.net/Kurulus-Osman/1.php?id={last_vid_num}"

print("Last video page:", last_vid)
print("""\n\n#############################################################
####-----------------""", end="")

if n > last_vid_num:
	print(colored(" CONGRATULATIONS", 'red'), end="")
	os.popen(f"firefox https://ardirilisertugrul.net/Kurulus-Osman/1.php?id=" + str(n))
else:
	print(colored("--- NO NEW VIDEO", 'red'), end="")

print(""" -------------------####
#############################################################\n""")

if n > last_vid_num:
	ans_ = input(f"\n\nAre you need to update {_file_name_} file?\n[y|n]  ")
	if ans_ == "y":
		open(_file_name_, 'w').write(str(n))
	print()