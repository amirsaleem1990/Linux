#!/home/amir/.local/bin/ipython3
from tabulate import tabulate
import pandas as pd
import requests
from bs4 import BeautifulSoup
url = "https://next-episode.net/kurulus-osman"
soup = BeautifulSoup(requests.get(url).text, "lxml")
l = [i.strip() for i in soup.find("div", {"id": "next_episode"}).text.split("\n")[3:] if i][:-1]
d = {}
for i in l:
	a = i.split(":")
	d[a[0]] = a[1]
df = pd.DataFrame(d, index=["info"]).T
print(tabulate(df))
print("\n\nhttps://ardirilisertugrul.net/Kurulus-Osman/home.php\n")

last_vid = f"https://ardirilisertugrul.net/Kurulus-Osman/1.php?id={26 + int(d['Name'].split()[-1])}"
print("Last video page:", last_vid)

s = BeautifulSoup(requests.get(last_vid).text, "lxml")
for i in s.select("li"):
	try:
		l = i['data-source']
		if "videoembed" in l:
			l = "https:" + l.strip()
			print("Last video Download/watch link:", l)
			break
	except:
		pass
s = BeautifulSoup(requests.get(l).text, "lxml")
print("Last video Duration:", s.find("div", {"class" : "vid-card_duration"}).text)
